---
title: Ch02 潛在結果（Potential Outcomes）
date: 2025-09-01
author: NTU Causal Inference
description: 因果推論課程筆記第二章，潛在結果框架、SUTVA、treatment assignment、完美醫生例子等
tags:
  - 潛在結果
  - SUTVA
  - 因果推論
  - perfect doctor
  - assignment mechanism
  - R code
---



# 2 Potential Outcomes

## 2.1 Experimentalist's View of Causal Inference

Rubin (1975) 和 Holland (1986) 提出一句著名的格言：  
**"no causation without manipulation."**  
（沒有操作，就沒有因果）  
【沒有人為的分配方式，就無法得出因果的關係】

This textbook also adopts this perspective, using the potential outcomes framework (Neyman, 1923; Rubin, 1974) to define causal effects.  
這本課本也採用這種觀點，並用 potential outcomes framework（Neyman, 1923; Rubin, 1974）來定義因果效果。

In this framework:  
在這個框架下：

- An experiment (or at least a thought experiment) involves a "treatment" (處置), and we are interested in the effect of this treatment on one or more outcomes (結果).
  - 一個實驗（或至少是一個思想實驗）會有一個「處置」（treatment），我們關心這個處置對一個或多個結果（outcome）的影響。
- Sometimes, treatment is also called intervention (介入) or manipulation (操作).
  - 有時候，treatment 也稱為 intervention（介入）或 manipulation（操作）。
- Each unit (e.g., a person) has a set of potential outcomes under different treatments, but in reality, we can only observe one of them (i.e., the "counterfactual" cannot be observed simultaneously).
  - 每個單位（如一個人）在不同處置下都有一組潛在結果（potential outcomes），但實際上只能觀察到其中一個（即「反事實」無法同時觀察）。
- The definition of causal effect is the comparison between "the outcome if treated" and "the outcome if not treated."
  - 因果效果的定義，就是比較「如果接受處置」與「如果沒接受處置」的結果差異。

This view emphasizes:  
這種觀點強調：

**Only when we can imagine or actually perform some manipulation/intervention does it make sense to discuss causality.**  
**只有當我們能夠想像或實際進行某種操作（manipulation/intervention）時，才有意義討論因果關係


### Examples of Interventions (with bilingual explanation)



- **(Example 2.0)**  
  If we are interested in whether social distancing policies affect mental health, the intervention is the presence or absence of such policies. (intervention: social distancing policy vs. no policy)  
  如果我們關心社交距離政策是否影響心理健康，這裡的「操作」就是「有無實施社交距離政策」。

- **Example 2.1**  
  If we are interested in the effect of taking aspirin or not on the relief of headaches, the intervention is taking aspirin or not.  
  如果我們關心服用阿斯匹靈是否能緩解頭痛，這裡的「操作」就是「有無服用阿斯匹靈」。

- **Example 2.2**  
  If we are interested in the effect of participating in a job training program or not on employment and wage, the intervention is participating in the job training program or not.  
  如果我們關心參加職業訓練計畫是否影響就業與薪資，這裡的「操作」就是「有無參加職業訓練」。

- **Example 2.3**  
  If we are interested in the effect of studying in a small classroom or a large classroom on standardized test scores, the intervention is studying in a small classroom or not.  
  如果我們關心小班或大班教學對標準化考試成績的影響，這裡的「操作」就是「是否在小班學習」。

- **Example 2.4**  
  Gerber et al. (2008) were interested in the effect of different get-out-to-vote messages on the voting behavior. The intervention is the different get-out-to-vote messages.  
  Gerber 等人（2008）關心不同催票訊息對投票行為的影響，這裡的「操作」就是「不同的催票訊息」。

- **Example 2.5**  
  Pearl (2018) claimed that we could infer the effect of obesity on life span. A popular measure of obesity is the body mass index (BMI), defined as the body mass divided by the square of the body height in units of kg/m². So the intervention can be different levels of BMI.  
  Pearl（2018）認為我們可以推論肥胖對壽命的影響。肥胖常用身體質量指數（BMI）衡量，BMI 為體重（公斤）除以身高（公尺）的平方。因此，這裡的「操作」就是「不同的 BMI 水準




However, there are different levels of ambiguity in the interventions above.

- The meanings of interventions in Examples 2.1–2.4 are relatively clear.
  - 例子 2.1–2.4 的「操作」定義相對明確。
- The meaning of intervention on BMI in Example 2.5 is less clear.
  - 但例子 2.5 中，對 BMI 的「操作」就不那麼明確。
- In particular, we can imagine different versions of BMI reduction: healthier diet, more physical exercise, bariatric surgery, etc. These different versions of the intervention can have quite different effects on the outcome.
  - 例如，BMI 的降低可以透過健康飲食、增加運動、減重手術等多種方式達成，而這些方式對結果的影響可能大不相同。
- In this book, we will view the intervention in Example 2.5 as ill-defined without further clarifications.
  - 因此，在本書中，若未進一步說明，例子 2.5 的「操作」會被視為定義不明（ill-defined）。

Another ill-defined intervention is race.  
另一個定義不明的「操作」是種族。

- Racial discrimination is an important issue in the labor market, but it is not easy to imagine an experiment to change the race of any experimental unit.
  - 勞動市場中的種族歧視是一個重要議題，但我們很難想像能對實驗單位「操作」其種族。
- Bertrand and Mullainathan (2004) give an interesting experiment that partially answers the question.
  - Bertrand 和 Mullainathan（2004）提出了一個有趣的實驗，部分回應了這個問題。







## 2.2 Formal notation of potential outcomes

Consider a study with $n$ experimental units indexed by $i = 1, \ldots, n$.  
假設有 $n$ 個實驗單位，分別以 $i = 1, \ldots, n$ 表示。

As a starting point, we focus on a treatment with two levels: 1 for the treatment and 0 for the control.  
首先考慮一個二元處置：1 代表接受處置，0 代表對照組。

For each unit $i$, the outcome of interest $Y$ has two versions: $Y_i(1)$ and $Y_i(0)$, which are potential outcomes under the hypothetical interventions 1 and 0.  
對每個單位 $i$，我們關心的結果 $Y$ 有兩個潛在結果：$Y_i(1)$ 和 $Y_i(0)$，分別對應於假設接受處置和未接受處置時的結果。

Neyman (1923) first used this notation. It seems intuitive but has some hidden assumptions. Rubin (1980) made the following clarifications on the hidden assumptions.  
Neyman（1923）首先使用這種記號。這種表示法直觀，但隱含了一些假設。Rubin（1980）對這些隱含假設做了如下澄清：

**Assumption 2.1 (no interference)**  
Unit $i$’s potential outcomes do not depend on other units’ treatments. This is sometimes called the no-interference assumption.  
**假設 2.1（無干擾）**  
單位 $i$ 的潛在結果不會受到其他單位處置的影響，這稱為「無干擾假設」。

**Assumption 2.2 (consistency)**  
There are no other versions of the treatment. Equivalently, we require that the treatment levels be well-defined, or have no ambiguity at least for the outcome of interest. This is sometimes called the consistency assumption.  
**假設 2.2（一致性）**  
不存在其他版本的處置。換句話說，處置必須定義明確，至少對於關心的結果不能有歧義，這稱為「一致性假設」。

> Assumption 2.1 can be violated in infectious diseases or network experiments.  
> 例如在傳染病或網絡實驗中，若我的朋友接種流感疫苗，即使我沒打，感染機率也會下降。
>
> Assumption 2.2 can be violated for treatments with complex components.  
> 例如研究吸菸對肺癌的影響時，香菸種類可能會有差異；研究大學教育對收入的影響時，學校類型和主修也可能影響結果。

Rubin (1980) called Assumptions 2.1 and 2.2 together the **Stable Unit Treatment Value Assumption (SUTVA)**.  
Rubin（1980）將上述兩個假設合稱為「穩定單位處置值假設（SUTVA）」。

---

**Assumption 2.3 (SUTVA)**  
Both Assumptions 2.1 and 2.2 hold.  
**假設 2.3（SUTVA）**  
即假設 2.1 和 2.2 同時成立。

---

Under SUTVA, Rubin (2005) called the $n \times 2$ matrix of potential outcomes the **Science Table**:

| $i$ | $Y_i(1)$ | $Y_i(0)$ |
|---|---|---|
| 1 | $Y_1(1)$ | $Y_1(0)$ |
| 2 | $Y_2(1)$ | $Y_2(0)$ |
| ... | ... | ... |
| $n$ | $Y_n(1)$ | $Y_n(0)$ |

在 SUTVA 下，Rubin（2005）稱這個 $n \times 2$ 的潛在結果矩陣為「Science Table」。

---

Due to the fundamental contributions of Neyman and Rubin to statistical causal inference, the potential outcomes framework is sometimes referred to as the Neyman Model, the Neyman–Rubin Model, or the Rubin Causal Model.  
由於 Neyman 和 Rubin 對統計因果推論的貢獻，這個框架有時也稱為 Neyman 模型、Neyman–Rubin 模型或 Rubin 因果模型。本書統一稱為「潛在結果框架」。

Causal effects are functions of the Science Table.  
因果效果是 Science Table 的函數。

Inferring individual causal effects $\tau_i = Y_i(1) - Y_i(0)$, $(i = 1, \ldots, n)$ is fundamentally challenging because we can only observe either $Y_i(1)$ or $Y_i(0)$ for each unit $i$, that is, we can observe only half of the Science Table.  
推論個體因果效果 $\tau_i = Y_i(1) - Y_i(0)$ 很困難，因為每個單位只能觀察到 $Y_i(1)$ 或 $Y_i(0)$ 其中之一，也就是說 Science Table 只能觀察到一半。

As a starting point, most parts of the book focus on the **average causal effect (ACE)**:

$$
\tau = \frac{1}{n} \sum_{i=1}^n \left\{ Y_i(1) - Y_i(0) \right\} = \frac{1}{n} \sum_{i=1}^n Y_i(1) - \frac{1}{n} \sum_{i=1}^n Y_i(0)
$$

作為起點，本書多數內容聚焦於「平均因果效果（ACE）」。

But we can extend our discussion to many other parameters (also called estimands).  
但我們也可以討論其他參數（estimands），例如中位數因果效果。






---





> 【師註】本身我們在做因果推論下結論時都要非常小心，學習 causal inference 最重要的是正確的詮釋（interpretation）。

> 【師註】Assumption 2.2（consistency）這裡的一致性，並不是統計學上常見的「一致性」概念。  
> 在因果推論裡的一些符號定義，和統計學傳統的符號定義可能會混淆。例如 $Y_i$ 等記號在不同領域有不同意義，需特別留意。
>



> 【師註】統計上，更多時候，我們關注的是整體的 causal effect，而不只是個體的。例如，失業，在某些條件下比較容易被估計。  
> In statistics, we are often more interested in the overall (population-level) causal effect rather than the individual effect. For example, unemployment rates are often easier to estimate under certain conditions.
>
> Although most studies focus on the difference, $Y_i(1) - Y_i(0)$, alternative versions like $Y_i(1) / Y_i(0)$ can also be used to define estimands.  
> 雖然大多數研究關注 $Y_i(1) - Y_i(0)$ 這種差異，也可以用 $Y_i(1) / Y_i(0)$ 等其他方式來定義 estimand（估計目標）。







---





## Formal Definition of Potential Outcomes

**The fundamental problem of causal inference:**  
For each unit, we can observe only one potential outcome, while the other(s) remain missing or counterfactual.  
因果推論的根本問題：對每個單位，我們只能觀察到一個潛在結果，其他則是缺失或反事實（counterfactual）。

---





### Science Table 示意

**Potential Outcomes Table**

| 單位 $i$ | $Y_i(1)$ | $Y_i(0)$ |
|:-------:|:--------:|:--------:|
| 1       | $Y_1(1)$ | $Y_1(0)$ | 
| 2       | $Y_2(1)$ | $Y_2(0)$ | 
| ...     | ...      | ...      | 
| $n$     | $Y_n(1)$ | $Y_n(0)$ | 

**Observed Data Table**

| 單位 $i$ | $Y_i(1)$ | $Y_i(0)$ | 
|:-------:|:--------:|:--------:|
| 1       | $Y_1(1)$ | ?        |
| 2       | ?        | $Y_2(0)$ |
| ...     | ...      | ...      |
| $n$     | ?        | $Y_n(0)$ |

- **Potential outcomes**: $Y_i(1)$, $Y_i(0)$  
  潛在結果：$Y_i(1)$、$Y_i(0)$
- **Observed data**: For each $i$, only one of $Y_i(1)$ or $Y_i(0)$ is observed.  
  實際觀察到的資料：每個單位僅能觀察到 $Y_i(1)$ 或 $Y_i(0)$ 其中之一。

---

### Estimands (Parameters)

Estimands are functions of potential outcomes.  
估計目標（estimand）是潛在結果的函數。

- 例如：平均因果效果（ACE）
  
  $$
  \tau = \frac{1}{n} \sum_{i=1}^n \left\{ Y_i(1) - Y_i(0) \right\}
  $$

---

### Estimator

Estimators are functions (statistics) of observed data.  
估計量（estimator）則是根據實際觀察到的資料計算的統計量。

---

> **重點整理：**  
> - 潛在結果（potential outcomes）是理論上的，通常無法完全觀察。  
> - 估計目標（estimand）是潛在結果的函數。  
> - 估計量（estimator）是用實際資料計算的統計量，用來推論估計目標






## 2.3 Treatment assignment mechanism 

Let $Z_i$ be the binary treatment indicator for unit $i$, vectorized as $\mathbf{Z} = (Z_1, \ldots, Z_n)$. The observed outcome of unit $i$ is a function of the potential outcomes and the treatment indicator:

$$
Y_i = 
\begin{cases}
Y_i(1), & \text{if } Z_i = 1 \\
Y_i(0), & \text{if } Z_i = 0
\end{cases}
\tag{2.1}
$$

$$
Y_i = Z_i Y_i(1) + (1 - Z_i) Y_i(0) \tag{2.2}
$$

$$
Y_i = Y_i(0) + Z_i \{ Y_i(1) - Y_i(0) \} \tag{2.3}
$$

$$
Y_i = Y_i(0) + Z_i \tau_i, \quad \text{where } \tau_i = Y_i(1) - Y_i(0) \tag{2.4}
$$

Equation (2.1) is the definition of the observed outcome. Equation (2.2) is equivalent to (2.1). It is a trivial fact, but Pearl (2010b) viewed it as the fundamental bridge between the potential outcomes and the observed outcome. Equations (2.3) and (2.4) highlight the fact that the individual causal effect $\tau_i = Y_i(1) - Y_i(0)$ can be heterogeneous across units.

The experiment reveals only one of unit $i$’s potential outcomes with the other one missing:

$$
Y^{\text{mis}}_i = 
\begin{cases}
Y_i(0), & \text{if } Z_i = 1 \\
Y_i(1), & \text{if } Z_i = 0
\end{cases}
$$

$$
Y^{\text{mis}}_i = Z_i Y_i(0) + (1 - Z_i) Y_i(1)
$$

The missing potential outcome corresponds to the opposite treatment level of unit $i$. For this reason, the potential outcomes framework is also called the counterfactual framework. Some people find the terminology “counterfactual framework” inaccurate because before the experiment, both the potential outcomes can be observed, and only after the experiment, one potential outcome is observed whereas the other potential outcome is counterfactual.

The treatment assignment mechanism, i.e., the probability distribution of $\mathbf{Z}$, plays an important role in inferring causal effects. 


The following simple numerical examples illustrate this point. We first generate potential outcomes from Normal distributions with the average causal effect close to $-0.5$.




### Perfect Doctor

假設有一位「完美醫生」，他完全知道每個病人的個體因果效果 $\tau_i = Y_i(1) - Y_i(0)$，並且只會將治療分配給那些 $\tau_i \geq 0$ 的病人。這樣的分配機制會導致觀察到的處置組與對照組平均結果差異與真實平均因果效果有很大不同。

#### R 語言模擬程式碼
```r
n = 500
Y0 = rnorm(n)
tau = -0.5 + Y0
Y1 = Y0 + tau

# 完美醫生：只給 tau >= 0 的人治療
Z = (tau >= 0)
Y = Z*Y1 + (1 - Z)*Y0
mean(Y[Z==1]) - mean(Y[Z==0])
# [1] 2.166509
```

如果是一位「毫無頭緒」的醫生，完全隨機分配治療（丟銅板），則觀察到的平均差異會接近真實平均因果效果。

```r
Z = rbinom(n, 1, 0.5)
Y = Z*Y1 + (1 - Z)*Y0
mean(Y[Z==1]) - mean(Y[Z==0])
# [1] -0.552064
```

---

#### Perfect Doctor 範例（課堂投影片對照）


##### Potential outcome

| $i$ | $Y_i(1)$ | $Y_i(0)$ |
|----:|---------:|---------:|
| 1   | 14       | 13       |
| 2   | 0        | 6        |
| 3   | 2        | 5        |
| 4   | 2        | 4        |
| 7   | 10       | 8        |
| 8   | 9        | 8        |
| …   | …        | …        |
| **Mean** | **5** | **7** |

##### Observed data

| $i$ | $Y_i(1)$ | $Y_i(0)$ | $Z_i$ | $Y_i$ |
|----:|---------:|---------:|------:|------:|
| 1   | 14       | ?        | 1     | 14    |
| 2   | ?        | 6        | 0     | 6     |
| 3   | ?        | 5        | 0     | 5     |
| 4   | ?        | 4        | 0     | 4     |
| 7   | 10       | ?        | 1     | 10    |
| 8   | 9        | ?        | 1     | 9     |
| …   | …        | …        | …     | …     |
| **Mean** | **11** | **5.4** |       |       |

!!! note "重點"
    The treatment assignment mechanism, specifically the probability distribution of $Z_i$, is crucial for inferring causal effects.  
    處置分配機制（$Z_i$ 的機率分布）對於推論因果效果至關重要。

---

這個例子說明：**如果治療分配不是隨機的，而是根據個體潛在結果決定，則觀察到的組間差異無法反映真實的平均因果效果。**

---

### 真實世界中的「完美醫生」現象

那你說這個 perfect doctor 呢？他的這個例子在現實世界中有沒有可能發生呢？當然有啊！我們來想想看，現實中確實可能出現類似的情境。

舉例來說，之前疫情期間出現了很多中藥的案例。有些中藥配合治療後，確實有助於改善某些症狀。但這裡面有沒有可能出現「完美醫生」的現象呢？其實是有的。

#### 醫生的選擇機制

在醫院裡，醫生決定誰要不要吃中藥，這個決策過程就有可能扮演「perfect doctor」的角色。例如：

1. **病人篩選**  
   醫生可能會根據病人的狀況來決定是否給予中藥。比如說，這個藥是自費的，醫生可能會在與病人溝通時，判斷這個病人是否有意願自費購買藥物，於是已經在這個階段做了篩選。

2. **病情輕重**  
   醫生也可能會傾向於讓病情較輕的病人嘗試中藥，而對於病情較重的病人則建議住院或採取更積極的治療措施。這樣的好意，反而導致接受中藥的病人本身就比較健康、症狀較輕。

3. **社經條件**  
   收入較高的病人更有可能接受自費藥物，而醫學研究普遍發現，收入較高的人健康狀況也通常較好。

#### 結果的偏誤

這樣一來，最後觀察到的「中藥有效」其實反映的是醫生選擇病人的機制，而不是中藥本身的效果。這種現象就和「perfect doctor」的例子很類似。

你會看到，雖然數據上顯示藥物有效，但這個「有效」其實是因為醫生經過某種程度的判斷和篩選，讓本來就比較健康、症狀較輕、收入較高的病人接受了治療。這時候，治療效果的估計就會產生偏誤，並不能代表藥物本身的真實效果。

---

> **總結：**  
> 「完美醫生」的例子在現實世界中確實可能發生，特別是在醫生根據病人特徵（如健康狀況、經濟能力等）來決定治療分配時。這會導致觀察到的治療效果高估，並不能反映治療本身的真實因果


---

---

## 下週進度與預習建議

下週進度：Chap 03–04

---

**Next week, we will cover Chapters 3 and 4 in the textbook.**  
You may preview these chapters to determine if the course aligns with your interests.

**Reading Assignment:**  
- Appendices C

**Recommended Practice:**  
- HW1.1  
- HW2.1（包含 2.3 節 Perfect Doctor 的 R 程式練習）

---

## Chap03 預告與重點

學過統計的人，會感受到衝擊，同樣是 Fisher 的東西，怎麼完全不一樣？  
但如果學過實驗設計的話，就衝擊會比較小，有 assign（隨機分派）的意思在裡面。

### 主要內容

- **Fisher Randomized Test**  
  Fisher 隨機化檢定是因果推論的經典方法，與傳統假設檢定（如 t 檢定、卡方檢定）在邏輯與推論方式上有本質差異。
- **和 Chi-square (卡方) 檢定的關係**  
  兩者在某些設計下結果一致，但推論邏輯不同。Fisher 檢定強調隨機分派的設計基礎，卡方檢定則是基於機率分布的近似。
- **隨機分派 (Random Assignment)**  
  隨機分派是實驗設計的核心，能夠保證處置組與對照組在潛在結果上的可比性，進而讓觀察到的平均差異可以合理推論為因果效果。
- **實驗設計與推論的連結**  
  會進一步說明為什麼設計（Design）比事後的統計分析更重要，並介紹 Fisher 的隨機化檢定如何直接連結到因果推論。

---

### 學習建議

- **預習建議**  
  建議先閱讀課本第 3、4 章，並特別注意隨機分派的設計邏輯與 Fisher 檢定的推論方式。
- **練習題**  
  - HW1.1  
  - HW2.1（包含 2.3 節 Perfect Doctor 的 R 程式練習）

---

### 小結

> **殊途同歸。**  
> 不同的統計方法與推論邏輯，最終都在尋找「設計良好」與「可解釋」的因果結論。  
> 學會分辨設計與分析的角色，是學習因果推論的關鍵。